# ConvertX-CN è¼¸å‡ºæ²»ç†è¦ç¯„

> **æ ¸å¿ƒç†å¿µï¼šConvertX-CN çš„äº¤ä»˜å–®ä½åªæœ‰å…©ç¨®ï¼šä¸€å€‹æª”æ¡ˆï¼Œæˆ–ä¸€å€‹ `.TRA`**
>
> **æ°¸é ä¸æœƒæ˜¯ä¸€å †æ•£æª”ã€‚**

---

## ğŸ“¦ TRA å°è£è¦ç¯„

### å”¯ä¸€åˆ¤æ–·æ¨™æº–ï¼ˆä¸å¯æ¨¡ç³Šï¼‰

| å¯¦éš›ç”¢å‡ºæª”æ¡ˆæ•¸ | è¡Œç‚º |
|----------------|------|
| **= 1** | ç›´æ¥äº¤ä»˜è©²æª”æ¡ˆ |
| **â‰¥ 2** | **å¿…é ˆå°è£ç‚º `.TRA`** |

ğŸ‘‰ **ä¸è«–åŸå› ã€ä¸è«–å·¥å…·ã€ä¸è«–ä½¿ç”¨è€…é æœŸâ€”â€”åªçœ‹æ•¸é‡ã€‚**

---

### TRA æ¨™æº–çµæ§‹

```text
output.tra
â”œâ”€â”€ preview.<ext>        â† å–®ä¸€å°é¢ï¼ä»£è¡¨æª”ï¼ˆå¿…é ˆï¼‰
â””â”€â”€ artifacts/           â† æ‰€æœ‰å¯¦éš›ç”¢ç”Ÿçš„è¼¸å‡º
    â”œâ”€â”€ frame_0001.jpg
    â”œâ”€â”€ frame_0002.jpg
    â”œâ”€â”€ frame_0003.jpg
    â””â”€â”€ ...
```

- **preview**ï¼šå¾è¼¸å‡ºçµæœä¸­é¸ä¸€å€‹ï¼Œé è¨­ä½¿ç”¨ç¬¬ä¸€å€‹ç”¢ç”Ÿçš„æª”æ¡ˆ
- **artifacts/**ï¼šåŒ…å«å…¨éƒ¨ç”¢ç”Ÿçš„è¼¸å‡º

---

### manifest.json æ ¼å¼

```json
{
  "platform": "ConvertX-CN",
  "version": "1.0.0",
  "task_type": "multi-output",
  "job_id": "abc123",
  "engine": "ffmpeg",
  "source_format": "video/mp4",
  "output_format": "image/jpeg",
  "preview": "preview.jpg",
  "artifacts_dir": "artifacts/",
  "artifact_count": 128,
  "packaged_as": "TRA",
  "created_at": "2026-01-26T10:00:00.000Z"
}
```

---

## ğŸ›  FFmpeg è¼¸å‡ºæ²»ç†

### ç¬¬ä¸€å„ªå…ˆï¼šä¿®æ­£ Pixel Formatï¼ˆå¼·åˆ¶ï¼‰

âŒ **ç¦æ­¢ä½¿ç”¨ï¼š**
```bash
-pix_fmt yuvj420p
```

âœ… **ä¸€å¾‹ä½¿ç”¨ï¼š**
```bash
-pix_fmt yuv420p
```

è‹¥æ¶‰åŠ scaleï¼Œå¿…é ˆæŒ‡å®š full rangeï¼š
```bash
-vf "scale=in_range=pc:out_range=pc"
```

### Deprecated Warning åŸå‰‡

- deprecated warning å±¬æ–¼å·²çŸ¥å•é¡Œ
- å¯éæ¿¾é¡¯ç¤º
- **æœªä¿®æ­£ pipeline ä¸å¾—è¦–ç‚ºæˆåŠŸè½‰æª”**

---

## ğŸ“„ PDF èˆ‡å¤šé æ–‡ä»¶çš„æ˜ç¢ºå®šç¾©

| æƒ…æ³ | è™•ç†æ–¹å¼ |
|------|----------|
| è¼¸å‡ºä»ç‚º **å–®ä¸€ PDF æª”**ï¼ˆä¸è«–é æ•¸ï¼‰ | ç›´æ¥äº¤ä»˜ï¼Œä¸ä½¿ç”¨ TRA |
| PDF è¢«è½‰ç‚º **å¤šå€‹æª”æ¡ˆ**ï¼ˆå¦‚å¤šå¼µåœ–ç‰‡ï¼‰ | **å¿…é ˆå°è£ç‚º `.TRA`** |

---

## ğŸ” è·¨å¼•æ“é€šç”¨æ²»ç†

ä¸è«–ä½¿ç”¨å“ªå€‹å·¥å…·ï¼š

- FFmpeg
- ImageMagick
- GraphicsMagick
- LibreOffice
- PDF å·¥å…·

**åªçœ‹ä¸€ä»¶äº‹ï¼šæœ€å¾Œç”¢ç”Ÿäº†å¹¾å€‹æª”æ¡ˆ**

| æª”æ¡ˆæ•¸ | è¡Œç‚º |
|--------|------|
| 1 å€‹ | ç›´æ¥çµ¦ |
| â‰¥ 2 å€‹ | ä¸€å®šåŒ…æˆ `.TRA` |

ğŸ‘‰ **å·¥å…·ä¸åŒï¼Œåˆ¤æ–·æ¨™æº–ç›¸åŒï¼Œè¼¸å‡ºè¡Œç‚ºä¸€è‡´**

---

## ğŸš« æ˜ç¢ºç¦æ­¢äº‹é …

1. âŒ **ç¦æ­¢ image2 + å›ºå®šæª”å + å¤šå¹€**
2. âŒ **ç¦æ­¢å¤šæª”è¼¸å‡ºç›´æ¥è£¸çµ¦ä½¿ç”¨è€…**
3. âŒ **ç¦æ­¢æœªå°è£å°±äº¤ä»˜å¤šå€‹æª”æ¡ˆ**
4. âŒ **ç¦æ­¢ä½¿ç”¨ deprecated pixel formatï¼ˆyuvj420pï¼‰**

---

## ğŸ“ ç›¸é—œæª”æ¡ˆ

| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| [src/transfer/traPackager.ts](../../src/transfer/traPackager.ts) | TRA å°è£æ ¸å¿ƒ |
| [src/transfer/traTypes.ts](../../src/transfer/traTypes.ts) | TRA é¡å‹å®šç¾© |
| [src/transfer/ffmpegGovernance.ts](../../src/transfer/ffmpegGovernance.ts) | FFmpeg æ²»ç† |
| [src/transfer/constants.ts](../../src/transfer/constants.ts) | å¸¸æ•¸å®šç¾© |

---

## ğŸ”§ é–‹ç™¼è€…æŒ‡å—

### å¦‚ä½•åœ¨æ–°è½‰æ›å™¨ä¸­ä½¿ç”¨ TRA

```typescript
import {
  isMultiOutputTask,
  autoPackageMultiOutput,
} from "../transfer";

// è½‰æ›å®Œæˆå¾Œæª¢æŸ¥
const { isMulti, fileCount } = isMultiOutputTask(outputDir, outputFormat);

if (isMulti) {
  const result = await autoPackageMultiOutput(outputDir, {
    jobId: jobId,
    engine: "your-engine-name",
    sourceFormat: inputFormat,
    outputFormat: outputFormat,
  });
  
  if (result) {
    return result.packagePath; // è¿”å› .tra æª”æ¡ˆè·¯å¾‘
  }
}
```

### TRA å°è£æµç¨‹ï¼ˆå¤šæª”è¼¸å‡ºæ™‚å¿…åšï¼‰

1. **Step 1**ï¼šé¸æ“‡ preview æª”æ¡ˆï¼ˆé è¨­ç¬¬ä¸€å€‹ï¼‰
2. **Step 2**ï¼šå»ºç«‹ `artifacts/` è³‡æ–™å¤¾ï¼Œæ”¾å…¥æ‰€æœ‰è¼¸å‡º
3. **Step 3**ï¼šç”¢ç”Ÿ `manifest.json`
4. **Step 4**ï¼šå°è£æˆ `.tra` æª”æ¡ˆ

---

## ğŸ“Œ è¡Œç‚ºç¸½çµ

```
å¯¦éš›ç”¢å‡º = 1 â†’ ç›´æ¥äº¤ä»˜
å¯¦éš›ç”¢å‡º â‰¥ 2 â†’ å°è£ç‚º .TRA äº¤ä»˜
```

**æ²’æœ‰ä¾‹å¤–ã€‚**
