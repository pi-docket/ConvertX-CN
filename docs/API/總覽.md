# API ç¸½è¦½

ConvertX-CN æä¾›å…©ç¨® API æœå‹™æ–¹å¼ï¼Œæ»¿è¶³ä¸åŒçš„æ•´åˆéœ€æ±‚ã€‚

---

## ğŸ†• Web UI å…§å»º APIï¼ˆç°¡æ˜“ä½¿ç”¨ï¼‰

Web UI æœå‹™ï¼ˆç«¯å£ 3000ï¼‰å…§å»ºç°¡æ˜“ API ç«¯é»ï¼Œé©åˆåŸºæœ¬ä½¿ç”¨å ´æ™¯ã€‚

### ç‰¹è‰²

- âœ… **é–‹ç®±å³ç”¨**ï¼šä¸éœ€é¡å¤–é…ç½®
- âœ… **èˆ‡ Web UI æ•´åˆ**ï¼šå…±ç”¨èªè­‰å’Œè¨­å®š
- âš ï¸ **åŠŸèƒ½å—é™**ï¼šä¸æ”¯æ´å®Œæ•´çš„ Job ç®¡ç†

---

## ğŸš€ RAS-API Serverï¼ˆæ¨è–¦ï¼‰

**å¾ v2.0.0 é–‹å§‹**ï¼Œæä¾›ç¨ç«‹çš„ Rust RAS-API Serverï¼ˆç«¯å£ 7890ï¼‰ï¼Œæ”¯æ´å®Œæ•´çš„ API åŠŸèƒ½ã€‚

### ç‰¹è‰²

- âœ… **å®Œæ•´åŠŸèƒ½**ï¼šå¼•æ“æŸ¥è©¢ã€æ ¼å¼é©—è­‰ã€Job ç®¡ç†
- âœ… **Swagger UI**ï¼šäº’å‹•å¼ API æ–‡ä»¶
- âœ… **Cold Start Ready**ï¼šæ ¼å¼é æ¸¬é–‹ç®±å³ç”¨
- âœ… **é«˜æ•ˆèƒ½**ï¼šRust å¯¦ä½œï¼Œä½è³‡æºæ¶ˆè€—
- âœ… **OpenAPI 3.0**ï¼šæ¨™æº–åŒ– API è¦æ ¼

### å¿«é€Ÿé–‹å§‹

```bash
# å¥åº·æª¢æŸ¥ï¼ˆä¸éœ€èªè­‰ï¼‰
curl http://localhost:7890/api/v1/health

# æŸ¥è©¢å¼•æ“ï¼ˆä¸éœ€èªè­‰ï¼‰
curl http://localhost:7890/api/v1/engines

# æŸ¥è©¢æ ¼å¼æ”¯æ´ï¼ˆä¸éœ€èªè­‰ï¼‰
curl http://localhost:7890/api/v1/formats/pdf/targets

# é©—è­‰è½‰æ›ï¼ˆä¸éœ€èªè­‰ï¼‰
curl -X POST http://localhost:7890/api/v1/validate \
  -H "Content-Type: application/json" \
  -d '{"source_format": "docx", "target_format": "pdf"}'

# Swagger UI
open http://localhost:7890/swagger-ui
```

ğŸ‘‰ **è©³ç´°èªªæ˜è«‹åƒé–± [RAS API å®Œæ•´ä½¿ç”¨æ–‡ä»¶](RAS-APIå®Œæ•´ä½¿ç”¨æ–‡ä»¶.md)**
- ğŸ” **æ™ºæ…§å»ºè­°**ï¼šè½‰æ›å¤±æ•—æ™‚æ¨è–¦æ›¿ä»£å¼•æ“
- ğŸ› ï¸ **20+ è½‰æ›å¼•æ“**ï¼šèˆ‡ Web UI å…±ç”¨å®Œæ•´è½‰æ›å™¨

---

## å¿«é€Ÿå•Ÿç”¨

API Server æ˜¯**é¸ç”¨åŠŸèƒ½**ï¼Œä¸å½±éŸ¿ Web UI ä½¿ç”¨ã€‚

### å•Ÿç”¨æ–¹å¼

```bash
docker compose --profile api up -d
```

### æœå‹™ç«¯å£

| æœå‹™           | ç«¯å£ | èªªæ˜               |
| -------------- | ---- | ------------------ |
| Web UI         | 3000 | ç¶²é ä»‹é¢           |
| RAS-API Server | 7890 | REST API & Swagger |

---

## API ç«¯é»

### REST API

- **Base URL**: `http://localhost:7890/api/v1`
- **Swagger UI**: `http://localhost:7890/swagger-ui`
- **Content-Type**: `application/json` æˆ– `multipart/form-data`

### GraphQL API

- **Endpoint**: `http://localhost:7890/graphql` (è¦åŠƒä¸­)

> â„¹ï¸ GraphQL API åœ¨ v2.0.0 æš«æ™‚åœç”¨ï¼Œå»ºè­°ä½¿ç”¨ REST API

---

## èªè­‰

æ‰€æœ‰ API è«‹æ±‚ï¼ˆé™¤å¥åº·æª¢æŸ¥å¤–ï¼‰éƒ½éœ€è¦ JWT Bearer Tokenï¼š

```http
Authorization: Bearer <your-jwt-token>
```

### Token çµæ§‹

```json
{
  "sub": "user-id",
  "exp": 1234567890,
  "iat": 1234567890,
  "email": "user@example.com",
  "roles": ["user"]
}
```

> API Server åªè² è²¬é©—è­‰ JWTï¼Œä¸è² è²¬ç”¢ç”Ÿ JWTã€‚Token æ‡‰ç”±ç¨ç«‹çš„èªè­‰æœå‹™ç”¢ç”Ÿã€‚

---

## ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸            | èªªæ˜         | é è¨­å€¼              |
| --------------- | ------------ | ------------------- |
| `RAS_API_HOST`  | ç›£è½åœ°å€     | `0.0.0.0`           |
| `RAS_API_PORT`  | ç›£è½åŸ        | `7890`              |
| `JWT_SECRET`    | JWT é©—è­‰å¯†é‘° | ï¼ˆéœ€è‡ªè¡Œè¨­å®šï¼‰      |
| `UPLOAD_DIR`    | ä¸Šå‚³ç›®éŒ„     | `./data/uploads`    |
| `OUTPUT_DIR`    | è¼¸å‡ºç›®éŒ„     | `./data/output`     |
| `MAX_FILE_SIZE` | æœ€å¤§æª”æ¡ˆå¤§å° | `524288000` (500MB) |

---

## å¿«é€Ÿç¯„ä¾‹

### å¥åº·æª¢æŸ¥

```bash
curl http://localhost:7890/api/v1/health
```

å›æ‡‰ï¼š

```json
{
  "data": {
    "status": "healthy",
    "version": "2.0.0",
    "timestamp": "2026-01-23T10:30:00Z"
  }
}
```

### åˆ—å‡ºå¼•æ“

```bash
curl http://localhost:7890/api/v1/engines
```

### è½‰æ›æª”æ¡ˆ

```bash
curl -X POST \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"source_format": "docx", "target_format": "pdf"}' \
  http://localhost:7890/api/v1/jobs
```

---

## ç›¸é—œæ–‡ä»¶

- [API ç«¯é»è©³ç´°èªªæ˜](ç«¯é».md)
- [API è¦æ ¼æ–‡ä»¶](../../api-server/docs/API_SPEC.md)
- [æ¶æ§‹èªªæ˜](../../api-server/docs/ARCHITECTURE.md)
